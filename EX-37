import string
from collections import Counter

# English letter frequency order (most common to least common)
ENGLISH_FREQ_ORDER = "ETAOINSHRDLCUMWFGYPBVKJXQZ"

def frequency_attack(ciphertext, top_n=10):
    # Count frequency of letters in ciphertext
    counts = Counter(ch for ch in ciphertext.upper() if ch in string.ascii_uppercase)
    sorted_cipher_letters = [item[0] for item in counts.most_common()]
    
    # Build mapping: ciphertext letters -> English frequency letters
    mapping = {}
    for i, letter in enumerate(sorted_cipher_letters):
        if i < len(ENGLISH_FREQ_ORDER):
            mapping[letter] = ENGLISH_FREQ_ORDER[i]
    
    # Generate candidate plaintexts
    candidates = []
    for shift in range(top_n):
        # Rotate English frequency order to produce different guesses
        rotated_order = ENGLISH_FREQ_ORDER[shift:] + ENGLISH_FREQ_ORDER[:shift]
        mapping_variant = {sorted_cipher_letters[i]: rotated_order[i] 
                           for i in range(len(sorted_cipher_letters))}
        
        plaintext_guess = ''.join(mapping_variant.get(ch, ch) for ch in ciphertext.upper())
        candidates.append(plaintext_guess)
    
    return candidates

# --- Demo ---
ciphertext = "WKH TXLFN EURZQ IRA MXPSV RYHU WKH ODCB GRJ"  # Caesar shift of "THE QUICK BROWN FOX JUMPS OVER THE LAZY DOG"

guesses = frequency_attack(ciphertext, top_n=10)
print("Ciphertext:", ciphertext)
print("\nTop 10 possible plaintexts:")
for i, guess in enumerate(guesses, 1):
    print(f"{i}. {guess}")
